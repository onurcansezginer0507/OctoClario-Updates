next
}
if (result_tb_pai$min_dips[i] < result_tb_pai[reference_pai_well,1]+1 && result_tb_pai$max_dips[i] > result_tb_pai[reference_pai_well,2]-1) {
result_tb_pai$genotype[i] <- "4G-5G"
} else if (result_tb_pai$min_dips[i] < result_tb_pai[reference_pai_well,1]+1 && result_tb_pai$max_dips[i] < result_tb_pai[reference_pai_well,2]-1){
result_tb_pai$genotype[i] <- "5G-5G"
} else if (result_tb_pai$min_dips[i] > result_tb_pai[reference_pai_well,1]+1 && result_tb_pai$max_dips[i] > result_tb_pai[reference_pai_well,2]-1){
result_tb_pai$genotype[i] <- "4G-4G"
}
}
result_tb_pai$Parameter <- c(rep(x = "PAI", nrow(result_tb_pai)))
result_tb_pai <- cbind(rownames(result_tb_pai),result_tb_pai)
result_tb_pai <- result_tb_pai[,c(1,6,8,7,4)]
colnames(result_tb_pai) <- c("Well" ,"Sample Name", "Parameter", "Genotype", "peak_1")
} else {
result_tb_pai <- data.frame()
}
##for two peak 11 parameter
if(nrow(list2DF(result_tb_list_11)) != 0){
for (i in 1:length(result_tb_list_11)) {
for (j in 1:nrow(result_tb_list_11[[i]])) {
for (k in 1:nrow(well_list_11[[i]])) {
if(rownames(result_tb_list_11[[i]])[j] == well_list_11[[i]]$Well[k]){
result_tb_list_11[[i]]$patient[j] <- well_list_11[[i]]$Sample[k]
}
}
}
}
for (i in 1:length(data_list_11)) {
all_peak <- c()
min_dips <- c()
max_dips <- c()
true_peak_rfu <- c()
melt_range <- melt_list_cvd[[names(data_list_11)[i]]]
lower_bound <- melt_range[1] - 3
upper_bound <- melt_range[2] + 3
for (j in 2:ncol(data_list_11[[i]])) {
if (max(data_list_11[[i]][,j]) < 0) {
min_dips <- c(min_dips, NA)
max_dips <- c(max_dips, NA)
} else {
min_dips <- c(min_dips, min(data_list_11[[i]][which(data_list_11[[i]][,j] > max(data_list_11[[i]][,j]/2)),1]))
max_dips <- c(max_dips, max(data_list_11[[i]][which(data_list_11[[i]][,j] > max(data_list_11[[i]][,j]/2)),1]))
}
for (k in 2:nrow(data_list_11[[i]]-1)) {
if(max(data_list_11[[i]][,j]) > 0){
if(data_list_11[[i]][k,1] > lower_bound && data_list_11[[i]][k,1] < upper_bound){
if (data_list_11[[i]][k+1,j] < data_list_11[[i]][k,j] && data_list_11[[i]][k-1,j] < data_list_11[[i]][k,j]) {
all_peak <- c(all_peak, data_list_11[[i]][k,j])
}
}
} else {
all_peak <- c(all_peak, 0)
}
}
true_peak_rfu <- sort(all_peak, decreasing = TRUE)
if (length(true_peak_rfu) == 0) {
result_tb_list_11[[i]]$peak_1[j-1] <- NA
} else {
result_tb_list_11[[i]]$peak_1[j-1] <- true_peak_rfu[1]
}
if (length(true_peak_rfu) > 1) {
if (true_peak_rfu[2] > true_peak_rfu[1]/3) {
result_tb_list_11[[i]]$peak_2[j-1] <- true_peak_rfu[2]
}
else {
result_tb_list_11[[i]]$peak_2[j-1] <- NA
}
} else {
result_tb_list_11[[i]]$peak_2[j-1] <- NA
}
all_peak <- c()
true_peak_rfu <- c()
}
result_tb_list_11[[i]]$min_dips <- min_dips
result_tb_list_11[[i]]$max_dips <- max_dips
}
for (i in 1:length(result_tb_list_11)) {
tm <- (melt_for_11[[names(result_tb_list_11)[i]]])
for (j in 1:nrow(result_tb_list_11[[i]])) {
if ("NTC" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_11[[i]])[j])]) {
result_tb_list_11[[i]]$genotype[j] <- "NTC"
next
}
if ("Positive Control" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_11[[i]])[j])]){
result_tb_list_11[[i]]$genotype[j] <- "Positive Control"
next
}
if (is.na(result_tb_list_11[[i]]$min_dips[j]) && is.na(result_tb_list_11[[i]]$max_dips[j])) {
result_tb_list_11[[i]]$Tm[j] <- NA
next
}
if (is.na(result_tb_list_11[[i]]$peak_2[j]) && names(result_tb_list_11)[i] %!in% c("HPAI", "FV-LEI", "FII")) {
result_tb_list_11[[i]]$Tm[j] <- as.numeric(data_list_11[[names(result_tb_list_11[i])]][which(data_list_11[[names(result_tb_list_11[i])]][,j+1] %in% result_tb_list_11[[i]]$peak_1),1])
} else if (is.na(result_tb_list_11[[i]]$peak_2[j]) == TRUE && names(result_tb_list_11)[i] == "HPAI"){
if(result_tb_list_11[[i]]$min_dips[j] < hpai_melt[1] && result_tb_list_11[[i]]$max_dips[j] > hpai_melt[2]) {
result_tb_list_11[[i]]$genotype[j] <- "Heterozygous"
} else {
result_tb_list_11[[i]]$Tm[j] <- data_list_11[[names(result_tb_list_11[i])]][which(data_list_11[[names(result_tb_list_11[i])]][,j+1] %in% result_tb_list_11[[i]]$peak_1),1]
}
} else if(is.na(result_tb_list_11[[i]]$peak_2[j]) == TRUE && names(result_tb_list_11)[i] == "FV-LEI"){
if(result_tb_list_11[[i]]$min_dips[j] < fv_melt[1] && result_tb_list_11[[i]]$max_dips[j] > fv_melt[2]) {
result_tb_list_11[[i]]$genotype[j] <- "Heterozygous"
} else {
result_tb_list_11[[i]]$Tm[j] <- data_list_11[[names(result_tb_list_11[i])]][which(data_list_11[[names(result_tb_list_11[i])]][,j+1] %in% result_tb_list_11[[i]]$peak_1),1]
}
} else if(is.na(result_tb_list_11[[i]]$peak_2[j]) == TRUE && names(result_tb_list_11)[i] == "FII"){
if(result_tb_list_11[[i]]$min_dips[j] < fii_melt[1]+1 && result_tb_list_11[[i]]$max_dips[j] > fii_melt[2]) {
result_tb_list_11[[i]]$genotype[j] <- "Heterozygous"
} else {
result_tb_list_11[[i]]$Tm[j] <- data_list_11[[names(result_tb_list_11[i])]][which(data_list_11[[names(result_tb_list_11[i])]][,j+1] %in% result_tb_list_11[[i]]$peak_1),1]
}
}  else if(is.na(result_tb_list_11[[i]]$peak_2[j]) == TRUE && names(result_tb_list_11)[i] == "FXIII"){
if(result_tb_list_11[[i]]$min_dips[j] < fxiii_melt[1]+1 && result_tb_list_11[[i]]$max_dips[j] > fxiii_melt[2]-1) {
result_tb_list_11[[i]]$genotype[j] <- "Heterozygous"
} else {
result_tb_list_11[[i]]$Tm[j] <- data_list_11[[names(result_tb_list_11[i])]][which(data_list_11[[names(result_tb_list_11[i])]][,j+1] %in% result_tb_list_11[[i]]$peak_1),1]
}
}
else {
result_tb_list_11[[i]]$genotype[j] <- "Heterozygous"
}
}
for (j in 1:nrow(result_tb_list_11[[i]])) {
if (is.na(result_tb_list_11[[i]]$Tm[j])) {
result_tb_list_11[[i]]$genotype[j] <- "No Peaks Detected Within the Boundaries."
} else if ("NTC" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_11[[i]])[j])]){
result_tb_list_11[[i]]$genotype[j] <- "NTC"
} else if ("Positive Control" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_11[[i]])[j])]){
result_tb_list_11[[i]]$genotype[j] <- "Positive Control"
} else if (result_tb_list_11[[i]]$genotype[j] == "Heterozygous" && names(result_tb_list_11[i]) == "ACE"){
result_tb_list_11[[i]]$genotype[j] <- "INS-DEL"
} else if (result_tb_list_11[[i]]$Tm[j] > tm && names(result_tb_list_11[i]) == "ACE"){
result_tb_list_11[[i]]$genotype[j] <- "DEL-DEL"
} else if (result_tb_list_11[[i]]$Tm[j] < tm && names(result_tb_list_11[i]) == "ACE"){
result_tb_list_11[[i]]$genotype[j] <- "INS-INS"
} else if ( result_tb_list_11[[i]]$genotype[j] == "Heterozygous"){
result_tb_list_11[[i]]$genotype[j] <- "Heterozygous"
} else if (result_tb_list_11[[i]]$Tm[j] > tm && names(result_tb_list_11[i]) != "A1298C"){
result_tb_list_11[[i]]$genotype[j] <- "Wild Type"
} else if (result_tb_list_11[[i]]$Tm[j] < tm && names(result_tb_list_11[i]) != "A1298C"){
result_tb_list_11[[i]]$genotype[j] <- "Homozygous Mutant"
} else if (result_tb_list_11[[i]]$Tm[j] > tm && names(result_tb_list_11[i]) == "A1298C"){
result_tb_list_11[[i]]$genotype[j] <- "Homozygous Mutant"
} else if (result_tb_list_11[[i]]$Tm[j] < tm && names(result_tb_list_11[i]) == "A1298C"){
result_tb_list_11[[i]]$genotype[j] <- "Wild Type"
}
}
}
} else {
result_tb_list_11 <- list()
}
##for apoe
if(ncol(data_list_apoe[[1]]) >1 && ncol(data_list_apoe[[1]]) == ncol(data_list_apoe[[2]])){
result_tb_list_apoe <- list()
result_tb_names_apoe <- c()
for (i in 1:2) {
if (ncol(data_list_apoe[[i]]) < 2) {
result_table_apoe <- data.frame()
next
}
result_table_apoe <- data.frame(row.names = colnames(data_list_apoe[[i]])[2:ncol(data_list_apoe[[i]])], min_dips = c(2:ncol(data_list_apoe[[i]])), max_dips = c(2:ncol(data_list_apoe[[i]])), peak_1 = c(2:ncol(data_list_apoe[[i]])), peak_2 = c(2:ncol(data_list_apoe[[i]])), Tm = c(2:ncol(data_list_apoe[[i]])), patient = c(2:ncol(data_list_apoe[[i]])), genotype = c(2:ncol(data_list_apoe[[i]])))
result_tb_list_apoe <- c(result_tb_list_apoe, list(result_table_apoe))
result_tb_names_apoe <- c(result_tb_names_apoe, names(well_list_apoe[i]))
}
names(result_tb_list_apoe) <- result_tb_names_apoe
well_list_apoe <- well_list_apoe[result_tb_names_apoe]
data_list_apoe <- data_list_apoe[result_tb_names_apoe]
for (i in 1:length(result_tb_list_apoe)) {
for (j in 1:nrow(result_tb_list_apoe[[i]])) {
for (k in 1:nrow(well_list_apoe[[i]])) {
if(rownames(result_tb_list_apoe[[i]])[j] == well_list_apoe[[i]]$Well[k]){
result_tb_list_apoe[[i]]$patient[j] <- well_list_apoe[[i]]$Sample[k]
}
}
}
}
for (i in 1:length(data_list_apoe)) {
all_peak <- c()
min_dips <- c()
max_dips <- c()
true_peak_rfu <- c()
melt_range <- melt_list_cvd[[names(data_list_apoe)[i]]]
lower_bound <- melt_range[1] - 3
upper_bound <- melt_range[2] + 3
for (j in 2:ncol(data_list_apoe[[i]])) {
if (max(data_list_apoe[[i]][,j]) < 50) {
min_dips <- c(min_dips, NA)
max_dips <- c(max_dips, NA)
} else {
min_dips <- c(min_dips, min(data_list_apoe[[i]][which(data_list_apoe[[i]][,j] > max(data_list_apoe[[i]][,j]/2)),1]))
max_dips <- c(max_dips, max(data_list_apoe[[i]][which(data_list_apoe[[i]][,j] > max(data_list_apoe[[i]][,j]/2)),1]))
}
for (k in 1:nrow(data_list_apoe[[i]])) {
if(k > 1 && k < nrow(data_list_apoe[[i]])){
if(data_list_apoe[[i]][k,1] > lower_bound && data_list_apoe[[i]][k,1] < upper_bound){
if (data_list_apoe[[i]][k+1,j] < data_list_apoe[[i]][k,j] && data_list_apoe[[i]][k-1,j] < data_list_apoe[[i]][k,j]) {
all_peak <- c(all_peak, data_list_apoe[[i]][k,j])
}
}
}
}
true_peak_rfu <- sort(all_peak, decreasing = TRUE)
if (length(true_peak_rfu) != 0) {
result_tb_list_apoe[[i]]$peak_1[j-1] <- true_peak_rfu[1]
}
if (length(true_peak_rfu) > 1) {
if (true_peak_rfu[2] > true_peak_rfu[1]/3) {
result_tb_list_apoe[[i]]$peak_2[j-1] <- true_peak_rfu[2]
} else {
result_tb_list_apoe[[i]]$peak_2[j-1] <- NA
}
} else {
result_tb_list_apoe[[i]]$peak_2[j-1] <- NA
}
all_peak <- c()
true_peak_rfu <- c()
}
result_tb_list_apoe[[i]]$min_dips <- min_dips
result_tb_list_apoe[[i]]$max_dips <- max_dips
}
for (i in 1:length(result_tb_list_apoe)) {
tm <- mean(melt_for_apoe[names(result_tb_list_apoe[i])])
for (j in 1:nrow(result_tb_list_apoe[[i]])) {
if ("NTC" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_apoe[[i]])[j])]) {
result_tb_list_apoe[[i]]$genotype[j] <- "NTC"
next
}
if ("Positive Control" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_apoe[[i]])[j])]) {
result_tb_list_apoe[[i]]$genotype[j] <- "Positive Control"
next
}
if (is.na(result_tb_list_apoe[[i]]$min_dips[j]) && is.na(result_tb_list_apoe[[i]]$max_dips[j])) {
result_tb_list_apoe[[i]]$Tm[j] <- NA
next
}
if (is.na(result_tb_list_apoe[[i]]$peak_2[j])) {
result_tb_list_apoe[[i]]$Tm[j] <- data_list_apoe[[names(result_tb_list_apoe[i])]][which(data_list_apoe[[names(result_tb_list_apoe[i])]][,j+1] %in% result_tb_list_apoe[[i]]$peak_1),1]
} else {
result_tb_list_apoe[[i]]$genotype[j] <- "Heterozygous"
}
}
for (j in 1:nrow(result_tb_list_apoe[[i]])) {
if (is.na(result_tb_list_apoe[[i]]$Tm[j])) {
result_tb_list_apoe[[i]]$genotype[j] <- NA
} else if ("NTC" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_apoe[[i]])[j])]){
result_tb_list_apoe[[i]]$genotype[j] <- "NTC"
} else if("Positive Control" %in% well_info$Content[which(well_info$Well %in% rownames(result_tb_list_apoe[[i]])[j])]){
result_tb_list_apoe[[i]]$genotype[j] <- "Positive Control"
} else if ( result_tb_list_apoe[[i]]$genotype[j] == "Heterozygous"){
result_tb_list_apoe[[i]]$genotype[j] <- "Heterozygous"
} else if (result_tb_list_apoe[[i]]$Tm[j] > tm && names(result_tb_list_apoe[i]) != "APOE1"){
result_tb_list_apoe[[i]]$genotype[j] <- "Wild Type"
} else if (result_tb_list_apoe[[i]]$Tm[j] < tm && names(result_tb_list_apoe[i]) != "APOE1"){
result_tb_list_apoe[[i]]$genotype[j] <- "Homozygous Mutant"
} else if (result_tb_list_apoe[[i]]$Tm[j] > tm && names(result_tb_list_apoe[i]) == "APOE1"){
result_tb_list_apoe[[i]]$genotype[j] <- "Homozygous Mutant"
} else if (result_tb_list_apoe[[i]]$Tm[j] < tm && names(result_tb_list_apoe[i]) == "APOE1"){
result_tb_list_apoe[[i]]$genotype[j] <- "Wild Type"
}
}
}
apoe1_table <- result_tb_list_apoe[[1]]
apoe1_table$Parameter <- "APOE1"
apoe1_table <- cbind(Well = rownames(apoe1_table), apoe1_table)
apoe2_table <- result_tb_list_apoe[[2]]
apoe2_table$Parameter <- "APOE2"
apoe2_table <- cbind(Well = rownames(apoe2_table), apoe2_table)
result_tb_list_apoe_final <- result_tb_list_apoe[[1]]
for(i in 1:nrow(result_tb_list_apoe[[1]])){
if (is.na(result_tb_list_apoe[[1]]$genotype[i]) || is.na(result_tb_list_apoe[[2]]$genotype[i])){
result_tb_list_apoe_final$genotype[i] <- "No Peaks Detected within the Boundaries."
}
if(result_tb_list_apoe[[1]]$genotype[i] == "Wild Type" && result_tb_list_apoe[[2]]$genotype[i] == "Homozygous Mutant"){
result_tb_list_apoe_final$genotype[i] <- "E2,E2"
} else if(result_tb_list_apoe[[1]]$genotype[i] == "Wild Type" && result_tb_list_apoe[[2]]$genotype[i] == "Wild Type"){
result_tb_list_apoe_final$genotype[i] <- "E3,E3"
} else if(result_tb_list_apoe[[1]]$genotype[i] == "Homozygous Mutant" && result_tb_list_apoe[[2]]$genotype[i] == "Wild Type"){
result_tb_list_apoe_final$genotype[i] <- "E4,E4"
} else if(result_tb_list_apoe[[1]]$genotype[i] == "Wild Type" && result_tb_list_apoe[[2]]$genotype[i] == "Heterozygous"){
result_tb_list_apoe_final$genotype[i] <- "E2,E3"
} else if(result_tb_list_apoe[[1]]$genotype[i] == "Heterozygous" && result_tb_list_apoe[[2]]$genotype[i] == "Heterozygous"){
result_tb_list_apoe_final$genotype[i] <- "E2,E4"
} else if(result_tb_list_apoe[[1]]$genotype[i] == "Heterozygous" && result_tb_list_apoe[[2]]$genotype[i] == "Wild Type"){
result_tb_list_apoe_final$genotype[i] <- "E3,E4"
} else if(result_tb_list_apoe[[1]]$genotype[i] == "NTC" && result_tb_list_apoe[[2]]$genotype[i] == "NTC"){
result_tb_list_apoe_final$genotype[i] <- "NTC"
} else {
result_tb_list_apoe_final$genotype[i] <- "Positive Control"
}
}
result_tb_list_apoe_final$Parameter <- "APOE"
result_tb_list_apoe_final <- cbind(Well = rownames(result_tb_list_apoe_final), result_tb_list_apoe_final)
result_tb_list_apoe_final <- result_tb_list_apoe_final[,c(1,7,9,8)]
colnames(result_tb_list_apoe_final) <- c("Well", "Sample Name", "Parameter", "Genotype")
apoe_table_final <- list(APOE1 = apoe1_table, APOE2 = apoe2_table, APOE = result_tb_list_apoe_final)
} else if (ncol(data_list_apoe[[1]]) >1 && ncol(data_list_apoe[[1]]) != ncol(data_list_apoe[[2]])){
apoe_table_final <- list(data.frame(), data.frame(), data.frame())
print("APOE genotypes cannot be calculated, please exclude the wells with only one of the APOE parameters were loaded.")
} else {
apoe_table_final <- list(data.frame(), data.frame(), data.frame())
}
for (i in 1:length(result_tb_list_11)) {
result_tb_list_11[[i]]$Parameter <- c(rep(names(result_tb_list_11[i]), nrow(result_tb_list_11[[i]])))
result_tb_list_11[[i]] <- cbind(rownames(result_tb_list_11[[i]]), result_tb_list_11[[i]])
result_tb_list_11[[i]] <- result_tb_list_11[[i]][,c(1,7,9,8,4,5)]
colnames(result_tb_list_11[[i]]) <- c("Well", "Sample Name", "Parameter", "Genotype", "peak_1", "peak_2")
}
result_tb_cvd <- c(result_tb_list_11, list(result_tb_pai), apoe_table_final)
names(result_tb_cvd) <- c(names(result_tb_list_11), "PAI", "APOE1", "APOE2", "APOE")
for (i in 1:length(result_tb_list_11)) {
result_tb_list_11[[i]] <- result_tb_list_11[[i]][!is.na(result_tb_list_11[[i]]$Genotype),]
}
result_tb_cvd <- result_tb_cvd[sapply(result_tb_cvd, function(x) dim(x)[1]) > 0]
return(list(result_tb_cvd,
data_list_graph))
}
x <- cvd_rotor_v2(choose.dir())
View(x)
source("C:/Users/OCTO-YAREN/Desktop/cvd_all_in_one_rotor.R", echo = TRUE)
x <- cvd_rotor_v2(choose.dir())
View(x)
View(x)
source("C:/Users/OCTO-YAREN/Desktop/octoclario V1.03 dev area/shiny-app/fmf_panel_v1.R", echo = TRUE)
source("~/.active-rstudio-document", echo = TRUE)
source("C:/Users/OCTO-YAREN/Desktop/fmf_panel_rotor.R", echo = TRUE)
source("C:/Users/OCTO-YAREN/Desktop/fmf_panel_rotor.R", echo = TRUE)
View(fmf_panel_rotor)
y <- fmf_panel_rotor(choose.dir())
getwd()
shiny::runApp()
source("C:/Users/OCTO-YAREN/Desktop/octoclario V1.04 dev area/shiny-app/cvd_all_in_one_rotor.R", echo = TRUE)
x <- cvd_all_in_one_rotor(choose.dir())
x <- cvd_all_in_one_rotor(choose.dir())
input_dir <- choose.dir()
# 1) Path to your CSV
csvs <- list.files(input_dir, pattern = "\\.csv$", full.names = TRUE, ignore.case = TRUE)
if (length(csvs) == 0) {
stop("No CSV file found in: ", input_dir)
}
if (length(csvs) > 1) {
stop("Multiple CSV files found: ", paste(basename(csvs), collapse = ", "))
}
# 2) find Excel(s)
xls  <- list.files(input_dir, pattern = "\\.(xlsx|xls)$", full.names = TRUE, ignore.case = TRUE)
if (length(xls) == 0) {
stop("No Excel file found in: ", input_dir)
}
if (length(xls) > 1) {
stop("Multiple Excel files found: ", paste(basename(xls), collapse = ", "))
}
f   <- csvs
# 2) Read all lines
raw <- readLines(f, encoding = "UTF-8")
# 3) Locate every header line containing ???Melt analysis of???
starts <- grep("Melt analysis of", raw, ignore.case = TRUE)
# 4) Extract each table into a list
melt_tables <- lapply(seq_along(starts), function(i) {
# data begins on the very next line (which contains your "ID; ???" header)
start <- starts[i] + 1
# and runs up to just before the next header (or end of file)
end   <- if (i < length(starts)) starts[i+1] - 1 else length(raw)
block <- raw[start:end]
# drop any purely-empty or ???;;;?????? rows
block <- block[!grepl("^\\s*;*\\s*$", block)]
# parse as a semicolon CSV with comma decimals
read.table(
text           = block,
sep            = ";",
dec            = ",",
header         = TRUE,
stringsAsFactors = FALSE,
check.names    = FALSE
)
})
# 6) rename each table
names(melt_tables)[grep(pattern = "Green", raw[starts])] <- "fam_data"
names(melt_tables)[grep(pattern = "Orange", raw[starts])] <- "rox_data"
names(melt_tables)[grep(pattern = "Red", raw[starts])] <- "cy5_data"
names(melt_tables)[grep(pattern = "Yellow", raw[starts])] <- "hex_data"
for (i in 1:length(melt_tables)) {
melt_tables[[i]] <- as.data.frame(t(melt_tables[[i]]))
melt_tables[[i]] <- cbind(rownames(melt_tables[[i]]), melt_tables[[i]])
colnames(melt_tables[[i]]) <- c("Temperature", melt_tables[[i]][1,2:ncol(melt_tables[[i]])])
melt_tables[[i]] <- melt_tables[[i]][3:nrow(melt_tables[[i]]),]
melt_tables[[i]] <- as.data.frame(apply(melt_tables[[i]], 2, as.numeric))
}
View(melt_tables)
cy5_data <- as.data.frame(melt_tables$cy5_data)
rox_data <- as.data.frame(melt_tables$rox_data)
fam_data <- as.data.frame(melt_tables$fam_data)
hex_data <- as.data.frame(melt_tables$hex_data)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste0("w", colnames(cy5_data)[2:ncol(cy5_data)])
View(cy5_data)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste0("w", colnames(cy5_data)[2:ncol(cy5_data)])
colnames(rox_data)[2:ncol(rox_data)] <- paste0("w", colnames(rox_data)[2:ncol(rox_data)])
colnames(fam_data)[2:ncol(fam_data)] <- paste0("w", colnames(fam_data)[2:ncol(fam_data)])
colnames(hex_data)[2:ncol(hex_data)] <- paste0("w", colnames(hex_data)[2:ncol(hex_data)])
cy5_data <- as.data.frame(melt_tables$cy5_data)
rox_data <- as.data.frame(melt_tables$rox_data)
fam_data <- as.data.frame(melt_tables$fam_data)
hex_data <- as.data.frame(melt_tables$hex_data)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste0("w", colnames(cy5_data)[2:ncol(cy5_data)])
colnames(rox_data)[2:ncol(rox_data)] <- paste0("w", colnames(rox_data)[2:ncol(rox_data)])
colnames(fam_data)[2:ncol(fam_data)] <- paste0("w", colnames(fam_data)[2:ncol(fam_data)])
colnames(hex_data)[2:ncol(hex_data)] <- paste0("w", colnames(hex_data)[2:ncol(hex_data)])
well_info <- read_excel(xls, sheet = 1)
well_info <- well_info[well_info$Selected == "Yes",]
well_info <- as.data.frame(well_info[,c(2,3,4,5)])
colnames(well_info) <- c("Well", "Sample", "Content", "Target")
well_info$Well <- paste0("w",well_info$Well)
View(well_info)
a1298_data <- as.data.frame(cy5_data[,c("Temperature", well_info[grep(pattern = "\\bCVDM1\\b", x = well_info$Target, ignore.case = TRUE),"Well"])])
well_info$Well
well_info$Well %in% colnames(cy5_data)
colnames(cy5_data)
cy5_data <- as.data.frame(melt_tables$cy5_data)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste0("w", colnames(cy5_data)[2:ncol(cy5_data)], collapse = "")
cy5_data <- as.data.frame(melt_tables$cy5_data)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste0("w", colnames(cy5_data)[2:ncol(cy5_data)], recycle0 = T)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste0("w", colnames(cy5_data)[2:ncol(cy5_data)], collapse = NA)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste("w", colnames(cy5_data)[2:ncol(cy5_data)])
cy5_data <- as.data.frame(melt_tables$cy5_data)
colnames(cy5_data)[2:ncol(cy5_data)] <- paste("w", colnames(cy5_data)[2:ncol(cy5_data)])
source("C:/Users/OCTO-YAREN/Desktop/octoclario V1.04 dev area/shiny-app/cvd_all_in_one_rotor.R", echo = TRUE)
x <- cvd_all_in_one_rotor(choose.dir())
source("C:/Users/OCTO-YAREN/Desktop/octoclario V1.04 dev area/shiny-app/cvd_all_in_one_rotor.R", echo = TRUE)
x <- cvd_all_in_one_rotor(choose.dir())
View(x)
getwd()
source("C:/Users/OCTO-YAREN/Desktop/octoclario V1.04 dev area/shiny-app/cvd_all_in_one_rotor.R", echo = TRUE)
x <- cvd_all_in_one_rotor(choose.dir())
View(x)
x[["results"]]
source("C:/Users/OCTO-YAREN/Desktop/octoclario V1.04 dev area/shiny-app/cvd_all_in_one_rotor.R", echo = TRUE)
x <- cvd_all_in_one_rotor(choose.dir())
x$results
x$plots
View(x)
View(x)
View(x)
dim(x)
dim(x)[1]
dim(x)[2]
x
dim(x)[[1]]
dim(x[1])
dim(x[[1]])
x
class(x)
class(x[1])
class(x[[1]])
class(x)[[1]]
class(x$results$`FV-LEI`)
dim(x$results$`FV-LEI`)
sapply(x, function(x) dim(x)[1] > 0)
sapply(x, function(x) dim(x$results)[1] > 0)
sapply(x, function(x) dim(x$results)[1]) > 0
sapply(x, function(x) dim(x)[[1]])
sapply(x, function(x) dim(x)[[1]]) > 0
sapply(x, function(x) dim(x)[1])
sapply(x, function(x) dim(x[[1]]))
sapply(x, function(x) dim(x[[1]])) >0
sapply(x, function(x) dim(x[[1]]))[1] >0
sapply(x, function(x) dim(x[[1]]))[1]
dim(x$results)
dim(x$results$`FV-LEI`)
x[[1]]
sapply(x, function(x) dim(x[[1]]))
sapply(x, function(x) dim(x[1]))
sapply(x, function(x) dim(x[1][1]))
sapply(x, function(x) dim(x$results))
sapply(x$results, function(x) dim(x)[1])
View(x[["results"]][["FV-LEI"]])
extract_results_plots <- function(raw) {
out <- list(results = list(), plots = list())
if (is.null(raw) || !is.list(raw)) return(out)
# Named: list(results=..., plots=...)
if (!is.null(names(raw))) {
if (!is.null(raw$results))
out$results <- Filter(is.data.frame, unlist(raw$results, recursive = FALSE))
if (!is.null(raw$plots) && is.list(raw$plots))
out$plots <- raw$plots
return(out)
}
# Positional: list(<list-of-dfs>, <list-of-plots>)
if (length(raw) >= 2) {
if (is.list(raw[[1]]))
out$results <- Filter(is.data.frame, unlist(raw[[1]], recursive = FALSE))
if (is.list(raw[[2]]))
out$plots <- raw[[2]]
return(out)
}
out$results <- Filter(is.data.frame, unlist(raw, recursive = TRUE))
out
}
extract_results_plots(x)
y <- extract_results_plots(x)
View(y)
y[["plots"]]
View(y[["plots"]][["FV-LEI"]])
filter(is.data.frame, unlist(x$results, recursive = FALSE))
Filter(is.data.frame, unlist(x$results, recursive = FALSE))
x$results
Filter(is.data.frame, unlist(x$results))
Filter(is.data.frame, unlist(x$results, recursive = FALSE))
Filter(is.data.frame, unlist(x$results, recursive = TRUE))
View(y)
Filter(is.data.frame, unlist(x, recursive = TRUE))
Filter(is.data.frame, unlist(x, recursive = FALSE))
z <- Filter(is.data.frame, unlist(x, recursive = FALSE))
View(z)
